{% extends 'base.html' %}
{% block title %}{{ _('settings_title') }} - {{ _('app_name') }}{% endblock %}
{% block content %}
<nav class="actions-row">
  <a class="btn btn-secondary" href="{{ url_for('dashboard') }}">{{ _('back_dashboard') }}</a>
</nav>

<section class="card">
  <h2>{{ _('language_settings') }}</h2>
  <form method="post" class="stack">
    <input type="hidden" name="action" value="language">
    <label>{{ _('preferred_language') }}
      <select name="preferred_language">
        <option value="en" {% if user.preferred_language == 'en' %}selected{% endif %}>{{ _('lang_en') }}</option>
        <option value="it" {% if user.preferred_language == 'it' %}selected{% endif %}>{{ _('lang_it') }}</option>
      </select>
    </label>
    <button class="btn" type="submit">{{ _('save_language') }}</button>
  </form>
</section>

<section class="card">
  <h2>{{ _('change_password') }}</h2>
  <form method="post" class="stack">
    <input type="hidden" name="action" value="password">
    <label>{{ _('current_password') }}
      <input type="password" name="current_password" required>
    </label>
    <label>{{ _('new_password') }}
      <input type="password" name="new_password" minlength="4" required>
    </label>
    <button class="btn" type="submit">{{ _('save_password') }}</button>
  </form>
</section>

<section class="card">
  <h2>{{ _('app_info') }}</h2>
  <div class="stack">
    <p class="muted">{{ _('app_version_label') }}: <strong>{{ app_version }}</strong></p>
    <p class="muted">{{ _('app_credits_label') }}: <strong>{{ app_credits }}</strong></p>
    <a class="btn btn-secondary" href="{{ app_repo_url }}" target="_blank" rel="noopener noreferrer">{{ _('app_repo_label') }}</a>
  </div>
</section>

<section class="card">
  <h2>{{ _('push_notifications_title') }}</h2>
  <div class="stack">
    <p class="muted">{{ _('push_notifications_desc') }}</p>
    <button id="push-toggle-btn" class="btn" type="button">{{ _('push_toggle_btn') }}</button>
    <p id="push-register-status" class="muted">{{ _('push_status_checking') }}</p>
    <hr>
    <button id="push-register-btn" class="btn btn-secondary" type="button">{{ _('push_register_now') }}</button>
    <p class="muted small">{{ _('push_register_hint') }}</p>
  </div>
</section>
{% endblock %}
